<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class Spi
   | Unosquare Raspbery Pi - libpigpio for .net </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class Spi
   | Unosquare Raspbery Pi - libpigpio for .net ">
    <meta name="generator" content="docfx 2.45.1.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/bootstrap.min.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="logo" src="../best-practices/resources/images/unosquare_logo.svg" alt="Unosquare">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar">
          <div class="container-fluid hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container-fluid body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container-fluid body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="Unosquare.PiGpio.NativeMethods.Spi">
  
  
  <h1 id="Unosquare_PiGpio_NativeMethods_Spi" data-uid="Unosquare.PiGpio.NativeMethods.Spi" class="text-break">Class Spi
  </h1>
  <div class="markdown level0 summary"><p>Provides methods for SPI bus management.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a></div>
    <div class="level1"><span class="xref">Spi</span></div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.tostring#System_Object_ToString">Object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.equals#System_Object_Equals_System_Object_">Object.Equals(Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.equals#System_Object_Equals_System_Object_System_Object_">Object.Equals(Object, Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.referenceequals#System_Object_ReferenceEquals_System_Object_System_Object_">Object.ReferenceEquals(Object, Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.gethashcode#System_Object_GetHashCode">Object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.gettype#System_Object_GetType">Object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.memberwiseclone#System_Object_MemberwiseClone">Object.MemberwiseClone()</a>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="Unosquare.PiGpio.NativeMethods.html">Unosquare.PiGpio.NativeMethods</a></h6>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class Spi</code></pre>
  </div>
  <h3 id="methods">Methods
  </h3>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIClose_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIClose*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIClose_Unosquare_PiGpio_NativeEnums_UserGpio_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIClose(Unosquare.PiGpio.NativeEnums.UserGpio)">BbSPIClose(UserGpio)</h4>
  <div class="markdown level1 summary"><p>This function stops bit banging SPI on a set of GPIO
opened with <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags_">BbSPIOpen(UserGpio, UserGpio, UserGpio, UserGpio, UInt32, SoftSpiFlags)</a>.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ResultCode BbSPIClose(UserGpio csPin)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">csPin</span></td>
        <td><p>0-31, the CS GPIO used in a prior call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags_">BbSPIOpen(UserGpio, UserGpio, UserGpio, UserGpio, UInt32, SoftSpiFlags)</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.ResultCode.html">ResultCode</a></td>
        <td><p>Returns 0 if OK, otherwise PI_BAD_USER_GPIO, or PI_NOT_SPI_GPIO.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIOpen*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIOpen(Unosquare.PiGpio.NativeEnums.UserGpio,Unosquare.PiGpio.NativeEnums.UserGpio,Unosquare.PiGpio.NativeEnums.UserGpio,Unosquare.PiGpio.NativeEnums.UserGpio,System.UInt32,Unosquare.PiGpio.NativeEnums.SoftSpiFlags)">BbSPIOpen(UserGpio, UserGpio, UserGpio, UserGpio, UInt32, SoftSpiFlags)</h4>
  <div class="markdown level1 summary"><p>This function selects a set of GPIO for bit banging SPI with
a specified baud rate and mode.</p>
<p>spiFlags consists of the least significant 22 bits.</p>
<p>mm defines the SPI mode, defaults to 0</p>
<p>p is 0 if CS is active low (default) and 1 for active high.</p>
<p>T is 1 if the least significant bit is transmitted on MOSI first, the
default (0) shifts the most significant bit out first.</p>
<p>R is 1 if the least significant bit is received on MISO first, the
default (0) receives the most significant bit first.</p>
<p>The other bits in flags should be set to zero.</p>
<p>If more than one device is connected to the SPI bus (defined by
SCLK, MOSI, and MISO) each must have its own CS.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ResultCode BbSPIOpen(UserGpio csPin, UserGpio misoPin, UserGpio mosiPin, UserGpio clockPin, uint baudRate, SoftSpiFlags spiFlags)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">csPin</span></td>
        <td><p>0-31.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">misoPin</span></td>
        <td><p>MISO 0-31.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">mosiPin</span></td>
        <td><p>MOSI 0-31.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">clockPin</span></td>
        <td><p>CLOCK 0-31.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint32">UInt32</a></td>
        <td><span class="parametername">baudRate</span></td>
        <td><p>50-250000.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.SoftSpiFlags.html">SoftSpiFlags</a></td>
        <td><span class="parametername">spiFlags</span></td>
        <td><p>see below.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.ResultCode.html">ResultCode</a></td>
        <td><p>Returns 0 if OK, otherwise PI_BAD_USER_GPIO, PI_BAD_SPI_BAUD, or PI_GPIO_IN_USE.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>21 20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0
0  0  0  0  0  0  R  T  0  0  0  0  0  0  0  0  0  0  0  p  m  m
Mode CPOL CPHA
0    0    0
1    0    1
2    1    0
3    1    1.</p>
</div>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags__examples">Examples</h5>
  <pre><code>bbSPIOpen(10, MISO, MOSI, SCLK, 10000, 0); // device 1
bbSPIOpen(11, MISO, MOSI, SCLK, 20000, 3); // device 2</code></pre>

  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIXfer_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIXfer*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIXfer_Unosquare_PiGpio_NativeEnums_UserGpio_System_Byte___System_Byte___System_UInt32_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BbSPIXfer(Unosquare.PiGpio.NativeEnums.UserGpio,System.Byte[],System.Byte[],System.UInt32)">BbSPIXfer(UserGpio, Byte[], Byte[], UInt32)</h4>
  <div class="markdown level1 summary"><p>This function executes a bit banged SPI transfer.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int BbSPIXfer(UserGpio csPin, byte[] inputBuffer, byte[] outputBuffer, uint count)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.UserGpio.html">UserGpio</a></td>
        <td><span class="parametername">csPin</span></td>
        <td><p>0-31 (as used in a prior call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_BbSPIOpen_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_Unosquare_PiGpio_NativeEnums_UserGpio_System_UInt32_Unosquare_PiGpio_NativeEnums_SoftSpiFlags_">BbSPIOpen(UserGpio, UserGpio, UserGpio, UserGpio, UInt32, SoftSpiFlags)</a>).</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><span class="parametername">inputBuffer</span></td>
        <td><p>pointer to buffer to hold data to be sent.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><span class="parametername">outputBuffer</span></td>
        <td><p>pointer to buffer to hold returned data.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint32">UInt32</a></td>
        <td><span class="parametername">count</span></td>
        <td><p>size of data transfer, which is the same as the data received.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>Returns &gt;= 0 if OK (the number of bytes read), otherwise PI_BAD_USER_GPIO, PI_NOT_SPI_GPIO or PI_BAD_POINTER.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_BbSPIXfer_Unosquare_PiGpio_NativeEnums_UserGpio_System_Byte___System_Byte___System_UInt32__examples">Examples</h5>
  <pre><code>// gcc -Wall -pthread -o bbSPIx_test bbSPIx_test.c -lpigpio
// sudo ./bbSPIx_test


#include &lt;stdio.h>

#include &quot;pigpio.h&quot;

#define CE0 5
#define CE1 6
#define MISO 13
#define MOSI 19
#define SCLK 12

int main(int argc, char *argv[])
{
   int i, count, set_val, read_val;
   unsigned char inBuf[3];
   char cmd1[] = {0, 0};
   char cmd2[] = {12, 0};
   char cmd3[] = {1, 128, 0};

   if (gpioInitialise() &lt; 0)
   {
      fprintf(stderr, &quot;pigpio initialisation failed.\n&quot;);
      return 1;
   }

   bbSPIOpen(CE0, MISO, MOSI, SCLK, 10000, 0); // MCP4251 DAC
   bbSPIOpen(CE1, MISO, MOSI, SCLK, 20000, 3); // MCP3008 ADC

   for (i=0; i&lt;256; i++)
   {
      cmd1[1] = i;

      count = bbSPIXfer(CE0, cmd1, (char *)inBuf, 2); // > DAC

      if (count == 2)
      {
         count = bbSPIXfer(CE0, cmd2, (char *)inBuf, 2); // &lt; DAC

         if (count == 2)
         {
            set_val = inBuf[1];

            count = bbSPIXfer(CE1, cmd3, (char *)inBuf, 3); // &lt; ADC

            if (count == 3)
            {
               read_val = ((inBuf[1]&amp;3)&lt;&lt;8) | inBuf[2];
               printf(&quot;%d %d\n&quot;, set_val, read_val);
            }
         }
      }
   }

   bbSPIClose(CE0);
   bbSPIClose(CE1);

   gpioTerminate();

   return 0;
}</code></pre>

  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_BscXfer_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BscXfer*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_BscXfer_Unosquare_PiGpio_NativeTypes_BscTransfer_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.BscXfer(Unosquare.PiGpio.NativeTypes.BscTransfer)">BscXfer(BscTransfer)</h4>
  <div class="markdown level1 summary"><p>This function provides a low-level interface to the
SPI/I2C Slave peripheral.  This peripheral allows the
Pi to act as a slave device on an I2C or SPI bus.</p>
<p>I can&apos;t get SPI to work properly.  I tried with a
control word of 0x303 and swapped MISO and MOSI.</p>
<p>The function sets the BSC mode, writes any data in
the transmit buffer to the BSC transmit FIFO, and
copies any data in the BSC receive FIFO to the
receive buffer.</p>
<p>To start a transfer set control (see below) and copy the bytes to
be sent (if any) to txBuf and set the byte count in txCnt.</p>
<p>Upon return rxCnt will be set to the number of received bytes placed
in rxBuf.</p>
<p>Note that the control word sets the BSC mode.  The BSC will stay in
that mode until a different control word is sent.</p>
<p>The BSC peripheral uses GPIO 18 (SDA) and 19 (SCL) in I2C mode
and GPIO 18 (MOSI), 19 (SCLK), 20 (MISO), and 21 (CE) in SPI mode.  You
need to swap MISO/MOSI between master and slave.</p>
<p>When a zero control word is received GPIO 18-21 will be reset
to INPUT mode.</p>
<p>The returned function value is the status of the transfer (see below).</p>
<p>If there was an error the status will be less than zero
(and will contain the error code).</p>
<p>The most significant word of the returned status contains the number
of bytes actually copied from txBuf to the BSC transmit FIFO (may be
less than requested if the FIFO already contained untransmitted data).</p>
<p>control consists of the following bits.</p>
<p>Bits 0-13 are copied unchanged to the BSC CR register.  See
pages 163-165 of the Broadcom peripherals document for full
details.</p>
<p>aaaaaaa @ defines the I2C slave address (only relevant in I2C mode)
IT      @ invert transmit status flags
HC      @ enable host control
TF      @ enable test FIFO
IR      @ invert receive status flags
RE      @ enable receive
TE      @ enable transmit
BK      @ abort operation and clear FIFOs
EC      @ send control register as first I2C byte
ES      @ send status register as first I2C byte
PL      @ set SPI polarity high
PH      @ set SPI phase high
I2      @ enable I2C mode
SP      @ enable SPI mode
EN      @ enable BSC peripheral</p>
<p>The returned status has the following format</p>
<p>Bits 0-15 are copied unchanged from the BSC FR register.  See
pages 165-166 of the Broadcom peripherals document for full
details.</p>
<p>SSSSS @ number of bytes successfully copied to transmit FIFO
RRRRR @ number of bytes in receieve FIFO
TTTTT @ number of bytes in transmit FIFO
RB    @ receive busy
TE    @ transmit FIFO empty
RF    @ receive FIFO full
TF    @ transmit FIFO full
RE    @ receive FIFO empty
TB    @ transmit busy</p>
<p>The following example shows how to configure the BSC peripheral as
an I2C slave with address 0x13 and send four bytes.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int BscXfer(BscTransfer bscTransfer)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeTypes.BscTransfer.html">BscTransfer</a></td>
        <td><span class="parametername">bscTransfer</span></td>
        <td><p>= a structure defining the transfer.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>The result code. 0 for success. See the <a class="xref" href="Unosquare.PiGpio.NativeEnums.ResultCode.html">ResultCode</a> enumeration.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_BscXfer_Unosquare_PiGpio_NativeTypes_BscTransfer__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>typedef struct
{
uint control;          // Write
int rxCnt;                 // Read only
char rxBuf[BSC_FIFO_SIZE]; // Read only
int txCnt;                 // Write
char txBuf[BSC_FIFO_SIZE]; // Write
} bsc_xfer_t;
22 21 20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0
a  a  a  a  a  a  a  -  - IT HC TF IR RE TE BK EC ES PL PH I2 SP EN
20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0
S  S  S  S  S  R  R  R  R  R  T  T  T  T  T RB TE RF TF RE TB.</p>
</div>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_BscXfer_Unosquare_PiGpio_NativeTypes_BscTransfer__examples">Examples</h5>
  <pre><code>bsc_xfer_t xfer;

xfer.control = (0x13&lt;&lt;16) | 0x305;

memcpy(xfer.txBuf, &quot;ABCD&quot;, 4);
xfer.txCnt = 4;

status = bscXfer(&amp;xfer);

if (status >= 0)
{
   // process transfer
}</code></pre>

  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_SpiClose_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiClose*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_SpiClose_System_UIntPtr_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiClose(System.UIntPtr)">SpiClose(UIntPtr)</h4>
  <div class="markdown level1 summary"><p>This functions closes the SPI device identified by the handle.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ResultCode SpiClose(UIntPtr handle)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uintptr">UIntPtr</a></td>
        <td><span class="parametername">handle</span></td>
        <td><blockquote><p>=0, as returned by a call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags_">SpiOpen(SpiChannelId, Int32, SpiFlags)</a>.</p>
</blockquote>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.ResultCode.html">ResultCode</a></td>
        <td><p>Returns 0 if OK, otherwise PI_BAD_HANDLE.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiOpen*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiOpen(Unosquare.PiGpio.NativeEnums.SpiChannelId,System.Int32,Unosquare.PiGpio.NativeEnums.SpiFlags)">SpiOpen(SpiChannelId, Int32, SpiFlags)</h4>
  <div class="markdown level1 summary"><p>This function returns a handle for the SPI device on the channel.
Data will be transferred at baud bits per second.  The flags may
be used to modify the default behaviour of 4-wire operation, mode 0,
active low chip select.</p>
<p>An auxiliary SPI device is available on all models but the
A and B and may be selected by setting the A bit in the flags.
The auxiliary device has 3 chip selects and a selectable word
size in bits.</p>
<p>spiFlags consists of the least significant 22 bits.</p>
<p>mm defines the SPI mode.</p>
<p>Warning: modes 1 and 3 do not appear to work on the auxiliary device.</p>
<p>px is 0 if CEx is active low (default) and 1 for active high.</p>
<p>ux is 0 if the CEx GPIO is reserved for SPI (default) and 1 otherwise.</p>
<p>A is 0 for the standard SPI device, 1 for the auxiliary SPI.</p>
<p>W is 0 if the device is not 3-wire, 1 if the device is 3-wire.  Standard
SPI device only.</p>
<p>nnnn defines the number of bytes (0-15) to write before switching
the MOSI line to MISO to read data.  This field is ignored
if W is not set.  Standard SPI device only.</p>
<p>T is 1 if the least significant bit is transmitted on MOSI first, the
default (0) shifts the most significant bit out first.  Auxiliary SPI
device only.</p>
<p>R is 1 if the least significant bit is received on MISO first, the
default (0) receives the most significant bit first.  Auxiliary SPI
device only.</p>
<p>bbbbbb defines the word size in bits (0-32).  The default (0)
sets 8 bits per word.  Auxiliary SPI device only.</p>
<p>The <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiRead_System_UIntPtr_System_Int32_">SpiRead(UIntPtr, Int32)</a>, <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiWrite_System_UIntPtr_System_Byte___">SpiWrite(UIntPtr, Byte[])</a>, and <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiXfer_System_UIntPtr_System_Byte___">SpiXfer(UIntPtr, Byte[])</a> functions
transfer data packed into 1, 2, or 4 bytes according to
the word size in bits.</p>
<p>For bits 1-8 there will be one byte per word.
For bits 9-16 there will be two bytes per word.
For bits 17-32 there will be four bytes per word.</p>
<p>Multi-byte transfers are made in least significant byte first order.</p>
<p>E.g. to transfer 32 11-bit words buf should contain 64 bytes
and count should be 64.</p>
<p>E.g. to transfer the 14 bit value 0x1ABC send the bytes 0xBC followed
by 0x1A.</p>
<p>The other bits in flags should be set to zero.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static UIntPtr SpiOpen(SpiChannelId spiChannel, int baudRate, SpiFlags spiFlags)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.SpiChannelId.html">SpiChannelId</a></td>
        <td><span class="parametername">spiChannel</span></td>
        <td><p>0-1 (0-2 for the auxiliary SPI device).</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">baudRate</span></td>
        <td><p>32K-125M (values above 30M are unlikely to work).</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Unosquare.PiGpio.NativeEnums.SpiFlags.html">SpiFlags</a></td>
        <td><span class="parametername">spiFlags</span></td>
        <td><p>see below.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uintptr">UIntPtr</a></td>
        <td><p>Returns a handle (&gt;=0) if OK, otherwise PI_BAD_SPI_CHANNEL, PI_BAD_SPI_SPEED, PI_BAD_FLAGS, PI_NO_AUX_SPI, or PI_SPI_OPEN_FAILED.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>21 20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0
b  b  b  b  b  b  R  T  n  n  n  n  W  A u2 u1 u0 p2 p1 p0  m  m
Mode POL PHA
0    0   0
1    0   1
2    1   0
3    1   1.</p>
</div>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_SpiRead_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiRead*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_SpiRead_System_UIntPtr_System_Int32_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiRead(System.UIntPtr,System.Int32)">SpiRead(UIntPtr, Int32)</h4>
  <div class="markdown level1 summary"><p>This function reads count bytes of data from the SPI
device associated with the handle.</p>
<p>PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static byte[] SpiRead(UIntPtr handle, int count)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uintptr">UIntPtr</a></td>
        <td><span class="parametername">handle</span></td>
        <td><blockquote><p>=0, as returned by a call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags_">SpiOpen(SpiChannelId, Int32, SpiFlags)</a>.</p>
</blockquote>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">count</span></td>
        <td><p>The max number of bytes to read.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><p>Returns the number of bytes transferred if OK, otherwise PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_SpiWrite_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiWrite*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_SpiWrite_System_UIntPtr_System_Byte___" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiWrite(System.UIntPtr,System.Byte[])">SpiWrite(UIntPtr, Byte[])</h4>
  <div class="markdown level1 summary"><p>This function writes count bytes of data from buf to the SPI
device associated with the handle.</p>
<p>PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int SpiWrite(UIntPtr handle, byte[] buffer)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uintptr">UIntPtr</a></td>
        <td><span class="parametername">handle</span></td>
        <td><blockquote><p>=0, as returned by a call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags_">SpiOpen(SpiChannelId, Int32, SpiFlags)</a>.</p>
</blockquote>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><span class="parametername">buffer</span></td>
        <td><p>the data bytes to write.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>Returns the number of bytes transferred if OK, otherwise PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="Unosquare_PiGpio_NativeMethods_Spi_SpiXfer_" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiXfer*"></a>
  <h4 id="Unosquare_PiGpio_NativeMethods_Spi_SpiXfer_System_UIntPtr_System_Byte___" data-uid="Unosquare.PiGpio.NativeMethods.Spi.SpiXfer(System.UIntPtr,System.Byte[])">SpiXfer(UIntPtr, Byte[])</h4>
  <div class="markdown level1 summary"><p>This function transfers count bytes of data from txBuf to the SPI
device associated with the handle. Simultaneously count bytes of
data are read from the device and placed in rxBuf.</p>
<p>PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static byte[] SpiXfer(UIntPtr handle, byte[] transmitBuffer)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uintptr">UIntPtr</a></td>
        <td><span class="parametername">handle</span></td>
        <td><blockquote><p>=0, as returned by a call to <a class="xref" href="Unosquare.PiGpio.NativeMethods.Spi.html#Unosquare_PiGpio_NativeMethods_Spi_SpiOpen_Unosquare_PiGpio_NativeEnums_SpiChannelId_System_Int32_Unosquare_PiGpio_NativeEnums_SpiFlags_">SpiOpen(SpiChannelId, Int32, SpiFlags)</a>.</p>
</blockquote>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><span class="parametername">transmitBuffer</span></td>
        <td><p>the data bytes to write.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.byte">Byte</a>[]</td>
        <td><p>Returns the number of bytes transferred if OK, otherwise PI_BAD_HANDLE, PI_BAD_SPI_COUNT, or PI_SPI_XFER_FAILED.</p>
</td>
      </tr>
    </tbody>
  </table>

<h3 id="disqus_thread">Comments</h3>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://unolabs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="doc" align="center">
              <span class="small mobile-hide">
                <img id="logo" class="doc-logo" src="../Support/pigpio-dotnet-256.png" alt="">
              </span>
            </div>
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2017-2019 <a href="https://www.unosquare.com">Unosquare</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-8535255-2', 'auto');
        ga('send', 'pageview');
    </script>
  </body>
</html>
